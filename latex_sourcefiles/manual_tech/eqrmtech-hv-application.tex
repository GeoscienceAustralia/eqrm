\chapter{The EQRM application}
\label{ch:application}

The Earthquake Risk Model (EQRM) is capable of:
\begin{enumerate}
\item earthquake scenario ground motion modeling; 
\item scenario loss forecasts; 
\item probabilistic seismic hazard analysis (PSHA); and
\item  probabilistic seismic risk analysis (PSRA).
\end{enumerate}
It is a product of
Geoscience Australia, an Australian Government Agency.

This chapter describes the EQRM application. Input files and
parameters are discussed and directions on how to run the EQRM
provided. Readers who are interested in only the EQRM methodology
and not the EQRM software package may wish to skip this chapter.

%\section{EQRM inputs}

The input files required by the EQRM depend on the nature of the
simulation conducted. For example, the inputs for a scenario loss
simulation are different to those required for a probabilistic
seismic hazard analysis. \tref{tab:input-overview} provides a
summary of the inputs required by the EQRM. The EQRM Demos in
\texttt{*/eqrm\_core/demo} provide examples of each input file and
demonstrate how to run the EQRM for each of the four main simulation
types. The following section provide an overview of each of the main
input files.

Except for the control file all input files are assumed to be in the
input directory, \texttt{input\_dir}, specified in the EQRM control
file.  If a file in not there it is looked for in
\texttt{*/eqrm\_core/resources/data}.

\begin{table}
\caption{Input files required for different types of simulation with
the EQRM. The asterisks indicate optional input files, the
requirement for which depends on settings in the EQRM control file}
\label{tab:input-overview} \centering
\begin{tabular}{|l|l|l|}
\hline
 & \textbf{hazard} & \textbf{risk} \\
\hline
\textbf{scenario} & EQRM control file & EQRM control file \\
  & amplification factors* & amplification factors* \\
  & hazard grid & building database \\
\hline
\textbf{probabilistic} & EQRM control file & EQRM controlfile\\
  & source file(s) & source file(s) \\
  & event type control file & event type control file \\
  & amplification factors* & amplification factors* \\
  & hazard grid & building database \\
\hline
\end{tabular}
\end{table}

\section{The EQRM Control File}
\label{sec:application-EQRMcf}

% First lets include the descriptom of the EQRM control file and its parameters
\input param_list_text

% Now lets include an example EQRM controlfile

\clearpage The following grey shaded box provides an
example of an EQRM controlfile to undertake a PSHA.

% Use a real file that is exected during distribution.
% This will automatically keep this small section 
% of the manual up-to-date.
%\lstinputlisting{xml_examples/EQRM_controlfile.py}
\lstinputlisting{../../demo/setdata_ProbHaz.py}


\clearpage
\section{The Source Files}

The EQRM source files for probabilistic modeling (PSHA and PSRA)
come in two forms. These are:
\begin{itemize}
\item source zones, and
\item faults.
\end{itemize}
The EQRM can be run with either of these inputs separately or both
together


\subsection{Source Zone File}
\label{sec:source-zone-file}


\begin{center}
\begin{tabular}{|c|}
\hline
 \\
 If \texttt{<zone\_source\_tag>} is defined then the file name is:\\
\texttt{<site\_tag>\_}\texttt{zone\_source\_}\texttt{<zone\_source\_tag>}\texttt{.xml}
\\
\\
Otherwise the file name is:\\
\texttt{<site\_tag>\_}\texttt{zone\_source}\texttt{.xml}\\
\\
\hline
\end{tabular} 
\end{center}

The source zone file is used to describe one or more areal source
zones. Earthquakes are assumed to be equally likely to occur
anywhere within a source zone. The magnitude recurrence relationship
for each source zone is defined by a bounded Gutenberg-Richter
relationship. The following grey shaded box provides an example of a
source zone file. A description of the parameters follows.
%\lstinputlisting{xml_examples/source_model_zone_example.xml}
\lstinputlisting{../../demo/input/newc_zone_source.xml}

\textbf{General inputs} (\texttt{source\_model\_zone})
\begin{itemize}
\item \texttt{magnitude\_type}: Earthquake magnitude used to derive the
recurrence parameters. NOTE - the EQRM only supports moment magnitude
\texttt{Mw}.
\end{itemize}

\textbf{General zone inputs} (\texttt{zone})
\begin{itemize}
\item \texttt{area}: Area of the source zone in km$^2$ 
\item \texttt{name}: Name for the source zone 
\item \texttt{event\_type}: Pointer to the collection of inputs described in the
event type controlfile.
\end{itemize}

\textbf{Geometry inputs} (\texttt{geometry})
\begin{itemize}

\item \texttt{azimuth}: Center azimuth for randomly generated
  synthetic ruptures (degrees).
  
\item \texttt{delta\_azimuth}: Range over which randomly generated
  azimuths will be sampled. That is, the azimuth of all synthetic
  earthquake will be randomly drawn from a uniform distribution
  between \texttt{azimuth}$\pm$\texttt{delta\_azimuth} (degrees).

\item \texttt{dip}: Center dip for randomly generated synthetic
  ruptures (degrees).
  
\item \texttt{delta\_dip}: Range over which randomly generated dips will
be sampled. That is, the dip of all synthetic earthquake will be
randomly drawn from a uniform distribution between
\texttt{dip}$\pm$\texttt{delta\_dip} (degrees).

\item \texttt{depth\_top\_seismogenic}: Depth (km) to the top of the
  seismogenic zone in km.  No component of a synthetic rupture will be
  located above this value.

\item \texttt{depth\_bottom\_seismogenic}: Depth (km) to the bottom of
  the seismogenic zone in km.  No component of a synthetic rupture
  will be located below this value.
 
\item \texttt{boundary}: Boundary of the areal source zone as
defined on the surface of the Earth in longitude (column 1) and
latitude (column 2). The first and last points must be the same to
close the polygon.

\item \texttt{excludes}: Boundary of any regions in the source in
  which events are not required. Boundary defined on the surface of
  the Earth in longitude (column 1) and latitude (column 2). The first
  and last points must be the same to close the polygon.This parameter
  is optional. the source zone file may have no \texttt{exclude}
  zones, a single entry or multiple entries.

\end{itemize}

\textbf{Recurrence inputs} (\texttt{recurrence\_model})
\begin{itemize}
\item \texttt{distribution}: Distribution used to define the magnitude recurrence relations. Note that
the EQRM current only supports a Bounded Gutenberg-Richter recurrence
relationship for source zones (i.e.
\typepar{bounded}{\_gutenberg}{\_richter}) 
\item \texttt{recurrence\_min\_mag}: Minimum magnitude used to
define the recurrence relationship 
\item \texttt{recurrence\_max\_mag}: Maximum magnitude used to
define the recurrence relationship. Typically, this is the magnitude
of the largest earthquake expected in the zone. 
\item \texttt{A\_min}: Expected number of earthquakes with magnitude \texttt{recurrence\_min\_mag}
or higher in the source zone per year.
\item \texttt{b}: Gutenberg-Richter b value for bounded Gutenberg-Richter recurrence
relationship 
\item \texttt{generation\_min\_mag}: Minimum magnitude for synthetic
earthquake generation. The EQRM will only generate synthetic
earthquakes with magnitudes equal to or greater than
\texttt{generation\_min\_mag}. 
\item \texttt{number\_of\_mag\_sample\_bins}: Number of magnitude
bins used to discretise the recurrence relationship in the magnitude
range \texttt{generation\_min\_mag} to
\texttt{recurrence\_max\_mag} 
\item \texttt{number\_of\_events}: Number of syntectic ruptures to
be generated in the source zone.
\end{itemize}

\subsection{Source Fault File}

\begin{center}
\begin{tabular}{|c|}
\hline
 \\
 If \texttt{<fault\_source\_tag>} is defined then the file name is:\\
\texttt{<site\_tag>\_}\texttt{fault\_source\_}\texttt{<fault\_source\_tag>}\texttt{.xml}
\\
\\
Otherwise the file name is:\\
\texttt{<site\_tag>\_}\texttt{fault\_source}\texttt{.xml}\\
\\
\hline
\end{tabular} 
\end{center}


The source faults file is used to describe one or more faults
(including crustal faults and subduction interfaces) and/or one or
more dipping slabs for intraslab earthquakes. Earthquakes are
assumed to be equally likely to occur anywhere within the fault (or
slab). The magnitude recurrence for faults can be defined by a
bounded Gutenberg-Richter relationship or a combination of bounded
Gutenberg-Richter and Characteristic. The magnitude recurrence for the
intraslab earthquakes must be defined by a bounded Gutenberg-Richter
relationship. The following grey box provides an example of a source
fault file with the following source types:
\begin{enumerate}
\item \textit{crustal fault} with recurrence defined by a bounded Gutenberg-Richter
relationship (\texttt{fault 1}), 
\item \textit{crustal fault} with recurrence defined by a combined bounded Gutenberg-Richter
(for small earthquakes) and a characteristic recurrence for larger
earthquakes (\texttt{fault 2}), 
\item a \textit{3D dipping volume} to represent intraslab earthquakes in the
subducting slab (\texttt{intraslab 1}).
\end{enumerate}
Many of the parameters in the source fault file are identical to
those described in \sref{sec:source-zone-file} and are not described
separately here. A description of the new parameters is provided
below. 

%\lstinputlisting{xml_examples/source_model_fault_example.xml}
\lstinputlisting{../../demo/input/newc_fault_source.xml}

\textbf{Parameters unique to the source fault file}
\begin{itemize}
\item \texttt{dip}: Dip of fault, defined as angle in degrees from
  horizontal.
  
\item \texttt{out\_of\_dip\_theta}: Out of plane dip, used for
  intraslab events. Angle between fault plane and out of dip rupture
  plane (degrees).

\item \texttt{delta\_theta}: Bounds the range of dips for intraslab
  events. That is, all synthetic ruptures will have uniformly random
  sampled dips in the range \texttt{dip + out\_of\_dip\_theta} $\pm$
  \texttt{delta\_theta} (degrees).

\item \texttt{slab\_width}: Width of slab (km) when using a fault
  source to represent intraslab earthquakes in the subducting slab.

\item \texttt{trace}: Surface trace of the fault along the surface
of the Earth. Note that it is the projection of the fault along the
direction of dip. It is defined by the latitude (\texttt{lat}) and
longitude (\texttt{lon}) of the start and end of the trace.
\item \texttt{slip\_rate}: Slip rate of fault in mm per year.

\item \texttt{distribution}: Distribution used to define the magnitude
  recurrence relations.  For faults the EQRM supports (i) a Bounded
  Gutenberg-Richter recurrence relationship
  (\texttt{bounded}\texttt{\_gutenberg}\texttt{\_richter}) or (ii) a
  combined Bounded Gutenberg-Richter and Characteristic model
  (\texttt{characteristic}). For intraslab earthquakes the EQRM
  supports only
  \texttt{bounded}\texttt{\_gutenberg}\texttt{\_richter}.

\item \texttt{recurrence\_max\_mag}: Maximum magnitude used to
define the recurrence relationship. Typically, this is the magnitude
of the largest earthquake expected on the fault (or in the
subducting slab).
\end{itemize}

\section{Event Type Control File}

\begin{center}
\begin{tabular}{|c|}
\hline
\\
Filename: \texttt{<site\_tag>\_}\texttt{event\_control\_}\texttt{<event\_control\_tag>}\texttt{.xml}\\
\\
\hline
\end{tabular}
\end{center}

The event type control file is a second level control file
facilitating the variation of selected EQRM parameters with event
types. The mechanism for this is an \texttt{event\_type} parameter
which links the \texttt{event\_type\_control} file with individual
sources (i.e. specific zones, faults or dipping slabs) in the
\texttt{fault\_source} and/or \texttt{zone\_source} files.
\lstinputlisting{xml_examples/event_type_controlfile_example.xml}

Parameters in the event type control file are separated into event
groups. These are blocks of input parameters defined by
\texttt{<event\_group} ... \texttt{</event\_group>}. Each of these
blocks is linked to a specific source in the source zone or source
fault files using \texttt{event\_type}.

The parameters enclosed within \texttt{<GMPE} ... \texttt{</GMPE>}
define the use of ground motion prediction equations. These
parameters include:
\begin{itemize}
\item \texttt{fault\_type}: fault mechanism used with the GMPE.
Allowable options are \texttt{normal}, \texttt{reverse} and
\texttt{strike\_slip}.
\item \texttt{branch}: specifies a branch for the GMPE logic tree.
There may be a single \texttt{branch} in which case a single GMPE is
used or multiple \texttt{branch}es in which case multiple GMPEs are
used in a logic tree. Inside each branch the user must specify the
chosen GMPEs (\texttt{model}: see below for a list of options) and
the weights (\texttt{weight}) for each branch. The weights
for all branches in a given \texttt{GMPE} block must sum to 1.
\end{itemize}

The parameters enclosed within \texttt{<scaling} and \texttt{/>}
 control the magnitude to size scaling during the generation of
 synthetic ruptures. These parameters include:
\begin{itemize}

\item \texttt{scaling\_rule}: Defines the set of scaling rules which
  link $M_w$ to area, length and/or width. Currently the only set of
  scaling rules supported by the EQRM are those defined by Wells and
  Coppersmith (1994). Therefore, the only allowable options are
  \texttt{Wells\_and\_Coppersmith\_94} and
  \texttt{modified\_Wells\_and\_Coppersmith\_94}.

\item \texttt{scaling\_fault\_type}: Fault mechanism used with the scaling rule.
Allowable options are \texttt{normal}, \texttt{reverse},
\texttt{strike\_slip} and \texttt{unspecified}. Typically,
\typepar{scaling}{\_fault}{\_type} will be the same as the GMPE 
\typepar{fault}{\_type}, however the EQRM does not enforce this.  \\
\end{itemize}


Current options for the GMPE are: \\
\vspace{1em}
\begin{tabular}{|p{\textwidth}|}
\hline
\texttt{"Gaull\_1990\_WA"} $\Rightarrow$ Gaull \textit{et al.} (1990); \\
\texttt{"Toro\_1997\_midcontinent"}  $\Rightarrow$ Toro \textit{et al.} (1997) model for \\
    \hspace{8em} mid-continent USA; \\
\texttt{"Atkinson\_Boore\_97"}  $\Rightarrow$ Atkinson \textit{et al.} (1997); \\
\texttt{"Sadigh\_97"}  $\Rightarrow$ Sadigh \textit{et al.} (1997); \\
\texttt{"Youngs\_97\_interface"}  $\Rightarrow$ Youngs \textit{et al.} (1997) interface ($Z_T$=0); \\
\texttt{"Youngs\_97\_intraslab"}  $\Rightarrow$ Youngs \textit{et al.} (1997) intraslab ($Z_T$=1); \\
\texttt{"Combo\_Sadigh\_Youngs\_M8"}  $\Rightarrow$ combined Youngs \textit{et al.} (1997) and Sadigh \\
    \hspace{8em} \textit{et al.} (1997); \\
\texttt{"Boore\_08"}  $\Rightarrow$ Boore \textit{et al.} (2008); \\
\texttt{"Sommerville09\_Yilgarn"} $\Rightarrow$ Sommerville (2009) Yilgarn Craton; \\
\texttt{"Sommerville09\_Non\_Cratonic"} $\Rightarrow$ Sommerville (2009) Average Non \\
    \hspace{8em} Cratonic model. \\
\texttt{"AllenSEA06"} $\Rightarrow$ Allen \textit{et al.} (2006) model for South Eastern Australia \\
\texttt{"Liang\_2008"} $\Rightarrow$ Liang \textit{et al.} (2006) \\
\texttt{"Atkinson06\_hard\_bedrock"} $\Rightarrow$ Atkinson and Boore (2006) model for hard \\
    \hspace{8em} bedrock ($V_{s30}$=760\,ms$^{-1}$)\\
\texttt{"Atkinson06\_bc\_boundary\_bedrock"} $\Rightarrow$ Atkinson and Boore (2006) model for \\
\hspace{8em} $V_{s30}$ at the NEHRP BC boundary\\
\texttt{"Campbell03"} $\Rightarrow$ Campbell (2003) hybrid empirical model\\
\texttt{"Abrahamson08"} $\Rightarrow$ Abrahamson \textit{et al.} (2008) NGA model\\
\texttt{"Chiou08"} $\Rightarrow$ Chiou and Youngs (2008) NGA model \\
\texttt{"Campbell08"} $\Rightarrow$ Campbell and Borzorgnia (2008) NGA model \\
\texttt{"Akkar\_2010\_crustal"} $\Rightarrow$ Akkar and Bommer (2010) model for Mediterranean \\
    \hspace{8em} and Middle East\\
\texttt{"Zhao\_2006\_interface"} $\Rightarrow$ Zhao \textit{et al.} (2006) model for earthquakes \\
    \hspace{8em} on the subduction interface near Japan \\
\texttt{"Atkinson\_2003\_intraslab"} $\Rightarrow$ Zhao \textit{et al.} (2006) model for \\
    \hspace{8em} earthquakes in the subducting slab near Japan\\
\texttt{"Atkinson\_2003\_interface"} $\Rightarrow$ Atkinson and Boore (2003) model for \\
    \hspace{8em} earthquakes on the subduction interface\\
\texttt{"Zhao\_2006\_intraslab"} $\Rightarrow$ Atkinson and Boore (2003) model for \\
    \hspace{8em} earthquakes in the subducting slab \\
\hline
\end{tabular}



\section{Site Files}


The EQRM requires a site file at which either hazard or loss will be modeled.

\subsection{Hazard Site File}

\begin{center}
\begin{tabular}{|c|}
\hline
\\
Filename: \texttt{<site\_tag>\_par\_site.csv} \\
\\
\hline
\end{tabular}
\end{center}

The site file for hazard is a csv file containing a list of points at which the hazard (PSHA simulation)
 or ground motion (scenario simulation) will be computed. An example is
 given below in the grey shaded box:
\lstinputlisting{xml_examples/java_par_site.csv}

\textbf{Parameters in the hazard site file:}
\begin{itemize}
\item \texttt{Latitude}: Latitude of the points of interest.
\item \texttt{Longitude}: Longitude of the points of interest.
\item \texttt{SITE\_CLASS}: Regolith site class. Typically, this is defined
by a letter. Note that the value of this parameter must match with
an amplification factor defined in the amplification file (see
\sref{sec:-appl-amplification})
\item \texttt{VS30}: Average velocity in the top 30\,m (i.e. $V_{s30}$). This is used
to incorporate regolith for GMPEs with a $V_{s30}$ term.
\end{itemize}

\subsection{Risk Site File (Building Database)}
\label{sec:grids-bdatabase}

\begin{center}
\begin{tabular}{|c|}
\hline
\\
Filename: \texttt{sitedb\_<site\_tag><site\_db\_tag>.csv} \\
\\
\hline
\end{tabular} 
\end{center}

The site file for risk is a csv file representing a building
portfolio. It contains a list of points at which the risk (PSHA simulation)
 or loss (scenario simulation) will be computed. An example is
 given below in the grey shaded box:
\lstinputlisting{xml_examples/sitedb_newc.csv}


\textbf{Parameters in the building database:}
\begin{itemize}
\item \texttt{BID}: Integer site identifier for EQRM (typically the same as column 10)
\item \texttt{LATITUDE}: Latitude of building
\item \texttt{LONGITUDE}: Longitude of building
\item \texttt{STRUCTURE\_CLASSIFICATION}: Index to building construction type... \textbf{expanded} HAZUS list (\sref{sec:grids-constructionclass})
\item \texttt{STRUCTURE\_CATEGORY}: Type of structure (e.g. building or bridge)
\item \texttt{HAZUS\_USAGE}: Index to HAZUS usage\index{building usgage!HAZUS} classification (\sref{sec:grids-usageclass})
\item \texttt{SUBURB}: within which building is located
\item \texttt{POSTCODE}: Postcode within which building is located
\item \texttt{PRE1989}: Logical index stating whether the building is pre- (0) or post- (1) the 1989 Newcastle earthquake
\item \texttt{HAZUS\_STRUCTURE\_CLASSIFICATION}: Index to building construction type... HAZUS list (\sref{sec:grids-constructionclass})
\item \texttt{CONTENTS\_COST\_DENSITY}: Replacement cost of contents in dollars per square meter (\sref{sec:grids-replacecosts})
\item \texttt{BUILDING\_COST\_DENSITY}: Replacement cost of building in dollars per square meter (\sref{sec:grids-replacecosts})
\item \texttt{FLOOR\_AREA}: Total floor area in square meters (summed over all stories)
\item \texttt{SURVEY\_FACTOR}: Survey factor indicating how many `real' buildings the database entry represents
\item \texttt{FCB\_USAGE}: Index to FCB\index{building usgage!FCB} usage classification (\sref{sec:grids-usageclass})
\item \texttt{SITE\_CLASS}:Regolith site class. Typically, this is defined
by a letter. Note that the value of this parameter must match with
an amplification factor defined in the amplification file (see
\sref{sec:-appl-amplification})
\item \texttt{VS30}: \textbf{WARNING}: Not yet operational for risk!
\end{itemize}


Typically the building database\index{building database} used with
the EQRM represents a subset of the true portfolio of interest.
When creating a database that sub-samples a larger portfolio,
individual database entries are used to represent more than one
`real' building. Such sub-sampling is undertaken to reduce run
times and memory requirements. Results from an EQRM  loss
simulation are scaled to the full portfolio using the \typesf.


\subsubsection{Building construction types}
\label{sec:grids-constructionclass}

Buildings have been subdivided into a number of building
types\index{building type} each with their own set of engineering
parameters uniquely defining the median capacity
curve\index{capacity curve} and the random variability around the
median. The building construction types are
based upon the HAZUS definitions (FEMA, 1999),% \citep{dr_FEMA99b},
with some further subdivisions recommended by Australian engineers for
Australian building construction types (Stehle \textit{et al.}, 2001).%\citep{dr_Stehle01a}.

In essence, the seven basic HAZUS types are
\begin{itemize}
\item Timber frame (W) \item Steel frame (S) \item Concrete frame
(C) \item Pre-cast concrete (PC) \item Reinforced masonry (R)
\item Unreinforced masonry (URM) \item Mobile homes (MH)
\end{itemize}
\begin{table}
 \caption{Definitions of the basic HAZUS building
construction types.} \vspace{0.8em} \label{tab:hazus-types}.
\centering
\begin{tabular}{|c|c|c|}
\hline
code & description & Stories\\
\hline
W1 & timber frame $<5\,000$ square feet & (1--2)\\
W2 & timber frame $> 5\,000$ square feet & (All)\\
\hline S1L &   & Low-Rise (1--3) \\
S1M & steel moment frame & Mid-Rise (4--7)\\
S1H & & High-Rise ($8+$)\\
\hline
S2L & & Low-Rise (1--3)\\
S2M & steel light frame & Mid-Rise (4--7)\\
S2M &  & High-Rise ($8+$)\\
\hline
S3 & steel frame + cast &  (All)\\
  & concrete shear walls  & \\
\hline
S4L & steel frame + & Low-Rise (1--3)\\
S4M & unreinforced masonry  & Mid-Rise (4--7)\\
S4H & in-fill walls& High-Rise ($8+$)\\
\hline
S5L & steel frame + & Low-Rise (1--3)\\
S5M & concrete shear & Mid-Rise (4--7)\\
S5H & walls  & High-Rise ($8+$)\\
\hline
C1L & & Low-Rise (1--3)\\
C1M &  concrete moment frame & Mid-Rise (4--7)\\
C1H & & High-Rise ($8+$)\\
\hline
C2L & & Low-Rise (1--3)\\
C2M & concrete shear walls  & Mid-Rise (4--7)\\
C2H & & High-Rise ($8+$)\\
\hline
C3L & concrete frame + & Low-Rise (1--3)\\
C3M & unreinforced masonry & Mid-Rise (4--7)\\
C3H & in-fill walls & High-Rise ($8+$)\\
\hline
PC1 & pre-cast concrete tilt-up walls & (All)\\
\hline
PC2L & pre-cast concrete  & Low-Rise (1--3)\\
PC2M &  frames with concrete  & Mid-Rise (4--7)\\
PC2H & shear walls & High-Rise ($8+$)\\
\hline
RM1L & reinforced masonry walls + & Low-Rise (1--3)\\
RM1M & wood or metal diaphragms  & Mid-Rise (4+)\\
\hline
RM2L & reinforced masonry & Low-Rise (1--3)\\
RM2M & walls + pre-cast & Mid-Rise (4--7)\\
RM2H & concrete diaphragms & High-Rise ($8+$)\\
\hline
URML & unreinforced & Low-Rise (1--2)\\
URMM & masonry & Mid-Rise (3+)\\
\hline
MH & Mobile homes & (All)\\
  \hline
\end{tabular}
\end{table}
There are further subdivisions of the HAZUS types into subtypes
according to numbers of stories in the building. These are given
in \tref{tab:hazus-types}.

The new Australian sub-types, developed by Australian engineers,
create further subdivisions of the HAZUS types
(Stehle \textit{et al.}, 2001). %\citep{dr_Stehle01a}.
In particular, the timber frame category
(W1) is subdivided into wall types (timber or brick veneer walls)
and roof types (metal or tiled); the unreinforced masonry types
(URML and URMM) into roof type (metal, tile or  otherwise), and
the concrete frame types are subdivided into soft-story or
non-soft story types. Soft-story refers to buildings that may have
a concrete basement or parking area but wood frame stories.

In total, we currently have 56 possible construction types
although some are rarely used. For example; the original HAZUS W1
is still there, however this is rarely used in favor of the more
detailed classification into W1TIMBMETAL, W1BVTILE, etc. A
complete list of all the building construction types is given in
\tref{tab:v-dam-allbtypes}.
%====================
%DR - must check this block - where is the EQRM Control file parameter???
%The EQRM control file parameter
%\typepar{hazus}{\_btypes}{\_flag} can be used to select between
%the use of the HAZUS building type\index{building type}
%classification and the Australian engineers extended HAZUS
%building type\index{building type} classification.
% ===================================

\begin{table}[htp]
\centering \caption{Complete list of all building construction
types (with those that are rarely used in italics).The integers
corresponding to each building construction type represent the
integer index used in the building database\index{building
database} Column 4 for expanded HAZUS types (column 12 for HAZUS
only types).} \vspace{0.8em} \label{tab:v-dam-allbtypes}.
\begin{tabular}{|llll|}
 \hline
\it 1: W1 &   15: S5H &     29: RM1L &           43: C1LSOFT  \\
    2: W2 &   16: \it C1L & 30: RM1M &           44: C1LNOSOFT \\
    3: S1L &  17: \it C1M & 31: RM2L &           45: C1MMEAN \\
    4: S1M &  18: \it C1H & 32: RM2M          &  46: C1MSOFT \\
    5: S1H &  19: C2L &     33: RM2H         &   47: C1MNOSOFT \\
    6: S2L &  20: C2M &     34: \it URML      &  48: C1HMEAN    \\
    7: S2M &  21: C2H &     35: \it URMM     &   49: C1HSOFT \\
    8: S2H &  22: C3L &     36: MH &             50: C1HNOSOFT \\
    9: S3 &   23: C3M &     37: W1MEAN &         51: URMLMEAN \\
    10: S4L & 24: C3H &     38: W1BVTILE&        52: URMLTILE  \\
    11: S4M & 25: PC1 &     39: W1BVMETAL&       53: URMLMETAL \\
    12: S4H & 26: PC2L &    40: W1TIMBERTILE  &  54: URMMMEAN \\
    13: S5L & 27: PC2M &    41: W1TIMBERMETAL  & 55: URMMTILE  \\
    14: S5M & 28: PC2H &    42: C1MMEAN       &  56: URMMMETAL \\
 \hline
\end{tabular}
\end{table}

% ====================================
% DR - must choose where to put these - probably should keep
% them in an appendix somewhere......
%The building capacity curve\index{capacity curve}s used in the
%Newcastle and Lake Macquarie study \citep{dr_Fulford02a} are
%provided in \aref{app:buildingpars},
%\tref{tab:vdam-building-parameters}. Other examples of the
%building capacity curve\index{capacity curve}s, as well as tools
%for manipulating them, can be found in the directory
%\typedir{*/eqrm}{/datacvt}{buildingpars}.
% ====================================

\subsubsection{Building usage types}
\label{sec:grids-usageclass}

The cost models used by the EQRM require knowledge of the
building's use in society. For example the value of a factory's
contents will vary from the value of a residents house. Similarly,
the cost associated with building a hospital and the cost of
building a local shop may differ even if the same materials are
used because the buildings may be built to different standards. To
transfer this information to the EQRM the building
database\index{building database}  stores information about
each building's usage. There are two different schemes that can be
used; the functional classification of building (FCB)
usage\index{building usgage!FCB} (ABS, 2001) %\citep{dr_ABS01a}
 and the HAZUS usage\index{building usgage!HAZUS} classification
(FEMA, 1999). %\citep{dr_FEMA99b}.


\begin{table}
\centering \caption{Functional classification of building
(FCB)\index{building usgage!FCB} \citep{dr_ABS01a} and integer
index used in the building database\index{building database}
column 15.} \vspace{0.8em} \label{tab:grids-FCB}  {\footnotesize .
\begin{tabular}{|c|p{0.8\textwidth}|}
 \hline
& \textbf{Residential: Separate, kit and transportable homes} \\
1 & 111: Separate Houses\\
2 & 112: Kit Houses\\
3 & 113: Transportable/relocatable homes\\
& \textbf{Residential: Semi-detached, row or terrace houses, townhouses}  \\
4 & 121: One storey\\
5 & 122: Two or more storeys\\
& \textbf{Residential: Flats, units or apartments} \\
6 & 131:  In a one or two storey block\\
7 & 132: In a three storey block\\
8 & 133:  In a four or more storey block\\
9 & 134:  Attached to a house\\
& \textbf{Residential: Other residential buildings} \\
10 & 191:  Residential: not otherwise classified \\
\hline
& \textbf{Commercial: Retail and wholesale trade building} \\
11 & 211:  Retail and wholesale trade buildings \\
& \textbf{Commercial: Transport buildings} \\
12 & 221:  Passenger transport buildings\\
13 & 222:  Non-passenger transport buildings\\
14 & 223:  Commercial carparks\\
15 & 224:  Transport: not otherwise classified\\
& \textbf{Commercial: Offices} \\
16 & 231:  Offices \\
& \textbf{Commercial: Other commercial buildings} \\
17 & 291:  Commercial: not otherwise classified\\
& \textbf{Industrial: Factories and other secondary production buildings} \\
18 & 311:  Factories and other secondary production buildings \\
& \textbf{Industrial: Warehouses} \\
19 & 321:  Warehouses (excluding produce storage) \\
& \textbf{Industrial: Agricultural and aquacultural buildings} \\
20 & 331:  Agricultural and aquacultural buildings \\
& \textbf{Industrial: Other industrial buildings} \\
21 & 391:  Industrial: not otherwise classified\\
\hline
& \textbf{Other Non-Residential: Education buildings} \\
22 & 411:  Education buildings \\
& \textbf{Other Non-Residential: Religion buildings} \\
23 & 421:  Religion buildings \\
& \textbf{Other Non-Residential: Aged care buildings} \\
24 & 431:  Aged care buildings \\
& \textbf{Other Non-Residential: Health facilities (not in 431)} \\
25 & 441:  Hospitals \\
26 & 442:  Health: not otherwise classified\\
& \textbf{Other Non-Residential: Entertainment and recreation buildings} \\
27 & 451:  Entertainment and recreation buildings \\
& \textbf{Other Non-Residential: Short term accommodation buildings} \\
28 & 461:  Self contained, short term apartments\\
29 & 462:  Hotels (predominately accommodation), motels, boarding houses, hostels or lodges\\
30 & 463:  Short Term: not otherwise classified\\
& \textbf{Other Non-Residential: Other non-residential buildings} \\
31 & 491:  Non-residential:not otherwise classified\\
\hline
\end{tabular}
}
\end{table}


\begin{table}
\centering \caption{HAZUS building usage
classification\index{building usgage!HAZUS} \citep{dr_FEMA99b} and
integer index used in the building database\index{building
database} column 5.} \label{tab:grids-HAZUSusage} \vspace{0.8em}
\begin{tabular}{|c|p{0.8\textwidth}|}
\hline
& \textbf{Residential}\\
1 & RES1: Single family dwelling (house)\\
2 & RES2: Mobile home\\
3 & RES3: Multi family dwelling (apartment/condominium) \\
4 & RES4: Temporary lodging (hotel/motel)\\
5 & RES5: Institutional dormitory (jails, group housing - military, colleges)\\
6 & RES6: Nursing home\\
\hline
& \textbf{Commercial}\\
7 & COM1: Retail trade (store)\\
8 & COM2: Wholesale trade (warehouse)\\
9 & COM3: Personal and repair services (service station, shop)\\
10 & COM4: Professional and technical services (offices)\\
11 & COM5: Banks\\
12 & COM6: Hospital\\
13 & COM7: Medical office and clinic\\
14 & COM8: Entertainment and recreation (restaurants, bars)\\
15 & COM9: Theaters\\
16 & COM10: Parking (garages)\\
\hline
& \textbf{Industrial}\\
17 & IND1: Heavy (factory)\\
18 & IND2: Light (factory)\\
19 & IND3: Food, drugs and chemicals (factory)\\
20 & IND4: Metals and mineral processing (factory)\\
21 & IND5: High technology (factory)\\
22 & IND6: Construction (office)\\
\hline
& \textbf{Agriculture}\\
23 & AGR1: Agriculture\\
\hline
& \textbf{Religion/Non/Profit}\\
24 & REL1: Church and non-profit\\
\hline
& \textbf{Government}\\
25 & GOV1: General services (office)\\
26 & GOV2: Emergency response (police, fire station, EOC)\\
\hline
& \textbf{Education}\\
27 & EDU1: Grade schools\\
28 & EDU2: Colleges and Universities (not group housing)\\
\hline
\end{tabular}
\end{table}

The FCB\index{building usgage!FCB} usage is summarised in
\tref{tab:grids-FCB} and the HAZUS usage
classification\index{building usgage!HAZUS} is summarised in
\tref{tab:grids-HAZUSusage}. The EQRM control file parameter
\typepar{buildings}{\_usage}{\_classification} can be used to switch between
the two usage classifications.


\subsubsection{Replacement costs}
\label{sec:grids-replacecosts}


The replacement cost in dollars per square meter for each building
and the replacement cost of the contents of each building are
contained within the building database\index{building database}
(see \sref{sec:grids-bdatabase}).
Typically these costs are a function of the usage classification
of the building and are hence also dependent on whether the
HAZUS\index{building usgage!HAZUS} or FCB\index{building
usgage!FCB} classification system is used. The EQRM does not cross
check how the costings were created. In some instances
it may be appropriate to use costings created from one usage
classification with the EQRM using the other usage mode (effects
cost splits - see below) and in some instance it may not be
appropriate to do so. Users are encouraged to familiarise
themselves with database metadata to ensure that they are using
the EQRM appropriately for their own application.


\clearpage

\section{Amplification File}
\label{sec:-appl-amplification}

\begin{center}
\begin{tabular}{|c|}
\hline
\\
Filename: \texttt{<site\_tag>\_par\_ampfactors.xml} \\
\\
\hline
\end{tabular} 
\end{center}

Local soil conditions (or regolith) are capable of amplifying
bedrock (or hard rock) ground motion. Consequently, it can be important
to incorporate regolith in hazard and/or risk studies.
The choice to use regolith is controlled by the EQRM control
file parameter \typepar{use}{\_amplification}. The manner in
which regolith (or amplification) is considered depends on
the GMPEs used. If a GMPE explicitly incorporates
regolith with a $V_{S30}$ term, then the EQRM will use this.
Otherwise the RSA is computed on bedrock and then amplified
to the regolith surface using a transfer function (or amplification factor).
An example of an input file containing amplification factors is provided in the grey box below.
\lstinputlisting{xml_examples/java_par_ampfactors.xml}

The amplification of seismic ground motion depends on the composition 
of the regolith. The EQRM accounts for variation in regolith material by assigning 
amplification factors to different site classes. The EQRM also recognises that 
amplification of seismic waves is a non-linear process. That is, the degree
of amplification is a function of the level of ground motion. To account for 
this non-linearity, the EQRM allows users to specify a number of amplification 
factors which are grouped according to the level of bedrock ground motion (as 
measured by PGA) and the size of the event (as measure by $M_w$).

The amplification factor file must specify the following parameters at the beginning: 
\begin{itemize} 
\item \texttt{moment\_magnitude\_bins}: centroids of the moment magnitude $M_w$ bins
 for which amplification factors are defined. 
\item \texttt{pga\_bins}: centroids of the PGA bins for which amplification factors are defined.
\item \texttt{site\_classes}: List of site classes for which amplification factors are defined. 
The EQRM assumes that each site class is defined by a single letter (e.g. \texttt{site\_class} = B). 
\item \texttt{periods}: RSA periods at which the amplification factors are defined. Note that 
these periods need not be the same as those in \typepar{atten}{\_}{periods} from the 
EQRM control file. The EQRM will interpolate as required. 
\end{itemize} 

The xml amplification factor file is then composed of a sequence of blocks, each of which 
defines:
\begin{itemize} 
\item the \texttt{site\_class} using the parameter \texttt{class}.
\item the \texttt{moment\_magnitude} bin centroid using the parameter \texttt{mag\_bin}. 
\item the \texttt{pga} bin centroid using the parameter \texttt{pga\_bin}. 
\end{itemize}

Finally the inside of each block specifies:
\begin{itemize}
\item \texttt{log\_amplification}: the logarithm of the median amplification factor defined at each 
of the RSA periods in \texttt{periods}.
\item \texttt{log\_std}: the standard deviation of the amplification factor. The EQRM assumes
 that the amplification factor is log-normally 
distributed when using this
standard deviation. The standard deviation can be set to an arbitrarily small 
number such as 0.01 (as shown in grey shaded box above) when not known. Use of this standard deviation is controlled by 
the EQRM control file parameter \texttt{amp\_variability\_method} which can also be set to \texttt{None}. 
\end{itemize}
